clear
name00='E:\SUTRA\Validation3-Cryosuction\Test 9';
name1=[name00,'\cryosuction_all2.DAT'];
time=72;
nods=6002;
fid = fopen(name1,'r');
q=0;
FormatString=repmat('%s ',1,nods+2);
ppp=textscan(fid,FormatString,time*5,'HeaderLines',q);
for i = 1:time*5
    for w = 1:nods+2
        all(i, w) = str2double(ppp{w}{i});
    end
end
fclose(fid);
q=3;p=4;
tem=(all(1:5:end,q:2:end)+all(1:5:end,p:2:end))/2;
pre=(all(2:5:end,q:2:end)+all(2:5:end,p:2:end))/2;
sii=(all(3:5:end,q:2:end)+all(3:5:end,p:2:end))/2;
sll=(all(4:5:end,q:2:end)+all(4:5:end,p:2:end))/2;
siout=(all(5:5:end,q:2:end)+all(5:5:end,p:2:end))/2;
sw=sii+sll;totwater=sw+siout;
h=linspace(30,0,3001);
totwater(:,1)=totwater(:,5);totwater(:,2)=totwater(:,5);totwater(:,3)=totwater(:,5);
ht1 = [-0 0.245 0.484 0.724 2.448 4.931 7.483 10.001 12.444 14.961 17.582 19.963 22.549 24.957 27.475]';
ht2 = [-0 0.929 2.482 4.931 7.449 8.824 9.933 12.478 14.859 17.411 19.963 22.480 24.957 27.653 29.651]';
ht6 = [0.067 2.379 5.068 7.449 9.892 12.409 14.961 17.513 19.928 22.480 24.998 27.509 29.480]';
ht12 = [0.033 2.448 4.931 7.552 9.933 12.546 14.996 17.513 20.031 22.549 24.998 27.475 29.582]';
ht24 = [0.067 2.585 5.034 6.724 7.962 9.892 12.512 14.927 17.582 19.963 22.515 24.923 27.475 29.719]';
ht48 = [0.067 2.448 4.966 7.066 10.001 12.444 13.826 15.030 17.376 19.928 22.515 25.101 27.578 29.719]';
ht72 = [ 0.033 2.516 4.897 6.963 7.586 9.036 9.892 12.444 13.894 14.996 17.582 19.997 22.583 25.101 27.475 29.822]';
t1 = [-4.369 -3.645 -3.130 -2.545 0.048 1.894 3.365 4.395 4.910 5.281 5.355 5.471 5.401 5.327 5.142]';
t2 = [ -4.647 -3.153 -1.353 0.516 1.964 2.548 2.970 3.741 4.418 4.770 5.026 5.095 5.118 5.118 5.026]';
t6 = [-5.200 -3.231 -1.316 0.085 1.018 1.723 2.470 3.124 3.639 4.103 4.525 4.850 4.956]';
t12 = [ -5.278 -3.761 -2.499 -1.330 -0.230 0.609 1.472 2.057 2.711 3.249 3.880 4.464 4.979]';
t24 = [-5.517 -4.302 -3.114 -2.529 -2.107 -1.314 -0.423 0.509 1.302 1.887 2.731 3.409 4.202 4.949]';
t48 = [ -5.417 -4.369 -3.385 -2.638 -1.585 -0.954 -0.444 -0.115 0.679 1.616 2.479 3.202 4.070 4.956]';
t72 = [-5.567 -4.681 -3.795 -3.020 -2.904 -2.389 -2.134 -1.364 -0.942 -0.640 0.297 1.206 2.143 3.052 3.943 4.829]';
w6 = [11.219, 11.178, 11.178, 11.406, 11.448, 11.364, 11.146, 11.105, 10.690, 10.357, 8.886, 8.928, 8.976, 8.592, 9.350, 9.080, 8.675, 9.350, 9.454, 9.984, 9.568, 10.430, 9.496, 9.984, 10.326, 10.025, 10.025, 9.942, 10.098, 10.139, 10.285, 9.537]';
wh6 = [0.175 0.839 1.605 2.269 2.912 3.452 4.191 5.060 5.573 5.895 7.058 8.016 9.028 9.966 10.978 11.970 12.956 13.941 14.981 15.939 16.999 18.012 19.045 20.037 20.872 21.987 22.945 23.909 24.942 25.982 26.968 27.905]';
w12 = [11.261, 10.960, 11.292, 11.292, 11.261, 11.333, 12.039, 12.870, 8.821, 8.806, 8.042, 8.333, 7.585, 8.706, 8.520, 8.821, 9.423, 9.350, 9.651, 10.285, 9.911, 10.170, 9.911, 9.869, 9.869, 9.755, 9.755]';
wh12 = [0.052 0.914 1.557 2.419 3.678 4.636 5.998 8.023 9.008 9.993 11.006 12.018 13.003 13.968 14.981 15.993 17.841 19.004 20.085 21.097 21.939 22.972 23.841 25.120 26.030 27.118 28.035]';
w24 = [11.178, 10.960, 11.333, 11.032, 11.105, 11.479, 12.122, 12.756, 13.088, 12.828, 12.870, 7.512, 6.879, 7.855, 7.959, 7.928, 8.520, 8.862, 8.748, 9.122, 10.212, 9.309, 9.381, 9.755, 9.568, 9.942, 9.610, 9.651]';
wh24 = [0.025 1.010 1.947 3.206 4.048 5.108 6.319 7.304 8.091 9.501 11.006 12.018 13.127 14.091 14.981 16.089 17.026 18.012 18.949 19.866 20.803 21.966 22.801 24.039 25.319 26.331 26.920 28.055]';
w48 = [11.105, 10.731, 11.375, 11.074, 10.991, 11.375, 12.797, 13.358, 12.828, 13.015, 15.113, 16.421, 8.935, 6.537, 7.097, 7.440, 7.855, 8.073, 7.398, 8.229, 7.658, 7.855, 7.928, 7.772, 8.146, 7.886]';
wh48 = [0.874, 2.112, 3.002, 4.281, 5.048, 6.156, 9.290, 10.528, 11.315, 12.177, 13.114, 13.956, 15.037, 16.029, 17.069, 17.979, 19.066, 19.928, 20.893, 21.954, 23.062, 23.951, 25.012, 25.970, 26.887, 28.980]';
w72 = [11.074, 10.804, 11.292, 11.178, 11.105, 11.292, 12.039, 12.870, 13.015, 13.358, 12.797, 13.804, 15.185, 16.535, 16.203, 10.212, 8.073, 7.806, 7.620, 7.578, 7.692, 7.910, 7.765, 7.505, 7.910, 8.139, 7.537, 8.367]';
wh72 = [-0.071 0.962 2.070 3.254 4.246 5.327 6.264 7.427 8.584 9.302 10.041 11.033 11.772 12.682 13.941 14.830 15.891 17.102 17.936 19.072 19.989 21.864 23.068 23.882 25.072 25.955 26.892 27.960]';
size1=8;
set (gcf,'unit','centimeters','position',[13,2,21,22]);
axes('unit','centimeters','position',[2 12 18 9]);
plot(ht6, t6, 'ko', 'MarkerSize', size1, 'linewidth', 1.5); hold on
plot(ht12, t12, 'ro', 'MarkerSize', size1, 'linewidth', 1.5); hold on;
plot(ht24, t24, 'bo', 'MarkerSize', size1, 'linewidth', 1.5); hold on;
plot(ht72, t72, 'go', 'MarkerSize', size1, 'linewidth', 1.5); hold on;
plot(h, tem(6,:), 'k-', 'linewidth', 1.5); hold on;
plot(h, tem(12,:), 'r-', 'linewidth', 1.5); hold on;
plot(h, tem(24,:), 'b-', 'linewidth', 1.5); hold on;
plot(h, tem(72,:), 'g-', 'linewidth', 1.5); hold on;
ylim([-6 6]); 
set(gca, 'YTick', [-6 -3 0 3 6], 'FontSize', 14);
set(gca, 'xTick', [], 'FontSize', 14);
ylabel('Temperature (\circC)');       
title('{\bfa)} Temperature');
legend('t=6h (Jame 1977)','t=12h (Jame 1977)','t=24h (Jame 1977)','t=72h (Jame 1977)',...
       't=6h (Simulation)','t=12h (Simulation)','t=24h (Simulation)','t=72h (Simulation)');
axes('unit','centimeters','position',[2 2 18 9]);
plot(wh6, w6/100*2.71, 'ko', 'MarkerSize', size1, 'linewidth', 1.5); hold on
plot(wh12, w12/100*2.71, 'ro', 'MarkerSize', size1, 'linewidth', 1.5); hold on;
plot(wh24, w24/100*2.71, 'bo', 'MarkerSize', size1, 'linewidth', 1.5); hold on;
plot(wh72, w72/100*2.71, 'go', 'MarkerSize', size1, 'linewidth', 1.5); hold on;
plot(h, totwater(6,:), 'k-', 'linewidth', 1.5); hold on;
plot(h, totwater(12,:), 'r-', 'linewidth', 1.5); hold on;
plot(h, totwater(24,:), 'b-', 'linewidth', 1.5); hold on;
plot(h, totwater(72,:), 'g-', 'linewidth', 1.5); hold on;
plot(h, 0.274*ones(3001,1), 'k--', 'linewidth', 1); hold on;
xlim([0 30]);   
ylim([0.1 0.6]);  
set(gca, 'YTick', [0.1 0.2 0.3 0.4 0.5 0.6], 'FontSize', 14);
xlabel('Distance from cold end (cm)');  
ylabel('Total water saturation (-)');   
title('{\bfb)} Total water saturation');
legend('t=6h (Jame 1977)','t=12h (Jame 1977)','t=24h (Jame 1977)','t=72h (Jame 1977)',...
       't=6h (Simulation)','t=12h (Simulation)','t=24h (Simulation)','t=72h (Simulation)');